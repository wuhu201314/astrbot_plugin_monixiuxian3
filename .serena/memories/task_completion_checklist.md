# 任务完成检查清单

完成编码任务后，应该进行以下检查：

## 代码质量检查

### 1. 语法和风格
- [ ] 代码符合项目的命名约定（常量大写、类驼峰、函数 snake_case）
- [ ] 所有函数都有适当的类型提示
- [ ] 异步函数正确使用 async/await
- [ ] 使用 dataclass 定义数据模型时包含了必要的类型提示
- [ ] 装饰器使用正确（@register, @filter.command, @migration）

### 2. 代码组织
- [ ] 新功能放在合适的层级（handlers/ 或 core/ 或 data/）
- [ ] 导入语句按标准库、第三方库、本地模块顺序组织
- [ ] 避免循环导入（使用 TYPE_CHECKING）
- [ ] 相关代码逻辑分组清晰

### 3. 错误处理
- [ ] 数据库操作有适当的错误处理
- [ ] 文件操作有适当的错误处理
- [ ] 用户输入有验证和错误提示

## 功能检查

### 4. 数据一致性
- [ ] 如果修改了数据模型，是否创建了相应的数据库迁移？
- [ ] 数据库迁移使用了正确的 @migration(version) 装饰器
- [ ] 新字段有合理的默认值
- [ ] 配置文件（JSON）格式正确

### 5. 配置更新
- [ ] 如果添加了新配置项，是否更新了 _conf_schema.json？
- [ ] 配置项有清晰的 description 和 hint
- [ ] 配置项有合理的 default 值

### 6. 文档更新
- [ ] 如果添加了新命令，是否更新了 README.md？
- [ ] 如果修改了核心功能，是否更新了相关文档？
- [ ] 版本号是否需要更新？（metadata.yaml）

## 测试

### 7. 基本测试
- [ ] 在 AstrBot 中加载插件成功
- [ ] 新功能的命令能够正确识别
- [ ] 正常流程能够正确执行
- [ ] 异常输入有适当的错误提示
- [ ] 权限控制正常工作（白名单检查）

### 8. 边界情况
- [ ] 测试空输入、错误输入
- [ ] 测试数值边界（0、负数、极大值）
- [ ] 测试并发场景（多个用户同时操作）

## 性能与安全

### 9. 性能考虑
- [ ] 数据库查询是否高效？
- [ ] 是否有不必要的重复查询？
- [ ] 大量数据的处理是否合理？

### 10. 安全考虑
- [ ] 用户输入是否经过验证？
- [ ] 是否有 SQL 注入风险？（应该没有，因为使用参数化查询）
- [ ] 是否有权限绕过风险？

## Git 提交

### 11. 版本控制
- [ ] 代码已添加到 git（git add）
- [ ] 提交信息清晰描述了改动（git commit）
- [ ] 如果需要，已推送到远程仓库（git push）

## 发布检查（如果是版本发布）

### 12. 发布准备
- [ ] 版本号已更新（metadata.yaml 和 README.md）
- [ ] 更新日志已添加到 README.md
- [ ] 所有测试通过
- [ ] 文档完整准确

---

**注意**：并非所有任务都需要完成所有检查项，根据实际情况选择相关的检查项。
