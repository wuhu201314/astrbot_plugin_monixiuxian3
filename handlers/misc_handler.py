# handlers/misc_handler.py
from astrbot.api.event import AstrMessageEvent
from ..data import DataBase

__all__ = ["MiscHandler"]


class MiscHandler:
    """杂项指令处理器 - 提供帮助信息"""

    def __init__(self, db: DataBase):
        self.db = db

    async def handle_help(self, event: AstrMessageEvent):
        """显示帮助信息"""
        help_text = (
            "📖 修仙指令大全 v2.7.1\n"
            "━━━━━━━━━━━━━━━\n"
            "\n"
            "📖【入门 & 基础】\n"
            "  我要修仙 [灵修/体修]\n"
            "    └─ 创建角色开始修行，灵修擅法术，体修擅肉身\n"
            "  我的信息\n"
            "    └─ 显示境界、修为、战力、装备等完整面板\n"
            "  签到\n"
            "    └─ 每日领取灵石(50-200)和修为奖励\n"
            "  改道号 <名称>\n"
            "    └─ 修改你的仙道称号\n"
            "\n"
            "🧘【修炼突破】\n"
            "  闭关\n"
            "    └─ 开始闭关修炼，离线也可积累修为\n"
            "  出关\n"
            "    └─ 结算闭关时间，获取对应修为\n"
            "  突破信息\n"
            "    └─ 查看当前境界突破所需修为、成功率、风险\n"
            "  突破 [丹药名]\n"
            "    └─ 尝试突破，可服用丹药增加成功率\n"
            "\n"
            "🎒【装备丹药】\n"
            "  我的装备 → 显示已装备的武器/防具/心法\n"
            "  装备 <名> → 从储物戒装备到身上\n"
            "  卸下 <名> → 卸下装备放回储物戒\n"
            "  丹药背包 → 查看拥有的丹药及效果\n"
            "  服用丹药 <名> → 使用丹药获得增益\n"
            "\n"
            "🏪【商店系统】\n"
            "  丹阁 → 丹药专卖(破境丹/修为丹/功能丹)\n"
            "  器阁 → 装备专卖(武器/防具/饰品)\n"
            "  百宝阁 → 综合商店(功法/材料/杂物)\n"
            "  购买 <物品名> [数量]\n"
            "    └─ 从当前商店购买物品，价格随折扣浮动\n"
            "\n"
            "📦【储物戒系统】(物品中央枢纽)\n"
            "  储物戒 → 查看储物空间和物品（分类显示）\n"
            "  存入 <物品名> [数量] → 存入物品\n"
            "  取出 <物品名> [数量] → 取出物品\n"
            "  搜索物品 <关键词> → 模糊搜索物品\n"
            "  取出所有 <分类> → 批量取出（材料/装备/功法/其他）\n"
            "  更换储物戒 <名称> → 升级储物戒（需灵石）\n"
            "  赠予 <@某人> <物品> [数量] → 赠送物品\n"
            "  接收 / 拒绝 → 处理赠予请求\n"
            "\n"
            "🏦【灵石银行】(0.1%日复利，逾期追杀)\n"
            "  银行 → 查看存款余额、利息和贷款状态\n"
            "  存灵石 <数量> → 存入，开始计息\n"
            "  取灵石 <数量> → 取出存款\n"
            "  领取利息 → 每日可领一次利息\n"
            "  贷款 <金额> → 普通贷款(0.5%日利率，7天)\n"
            "  突破贷款 <金额> → 短期贷款(0.8%日利率，3天)\n"
            "  还款 → 偿还贷款(本金+利息)\n"
            "  银行流水 → 查看最近交易记录\n"
            "  ⚠️ 逾期将被银行追杀致死！\n"
            "\n"
            "📜【悬赏任务】(完成获奖励+物品)\n"
            "  悬赏令 → 查看当前可接取的悬赏任务\n"
            "  接取悬赏 <编号> → 接取指定任务\n"
            "  悬赏状态 → 查看任务进度\n"
            "  完成悬赏 → 提交任务领取奖励\n"
            "  放弃悬赏 → 放弃当前任务\n"
            "\n"
            "🏛️【宗门】(加入宗门获额外收益)\n"
            "  创建宗门 <名> → 消耗灵石创建宗门\n"
            "  加入宗门 <名> → 加入已有宗门\n"
            "  我的宗门 → 查看宗门信息和成员\n"
            "  宗门列表 → 查看所有宗门排名\n"
            "  退出宗门 / 宗门捐献 <数量>\n"
            "\n"
            "⚔️【战斗竞技】\n"
            "  切磋 <@某人> → 友好切磋，无损失\n"
            "  决斗 <@某人> → 生死之战，败者损修为\n"
            "  世界Boss → 查看Boss信息和血量\n"
            "  挑战Boss → 挑战Boss获取奖励+物品掉落\n"
            "  传承挑战 <@某人> → 争夺对方传承加成\n"
            "  传承排行 → 查看传承榜\n"
            "\n"
            "📊【排行榜】\n"
            "  境界排行 / 战力排行 / 灵石排行\n"
            "  宗门排行 / 存款排行\n"
            "\n"
            "🚶【历练系统】(外出获取修为+物品)\n"
            "  开始历练 [短途/中途/长途]\n"
            "    └─ 短途30分/中途1小时/长途2小时\n"
            "  历练状态 → 查看历练进度\n"
            "  完成历练 → 领取奖励（含物品掉落）\n"
            "  历练信息 → 查看事件概率说明\n"
            "\n"
            "🌀【秘境探索】(探险获取奖励+物品)\n"
            "  秘境列表 → 查看可探索秘境及奖励\n"
            "  探索秘境 <ID> → 进入秘境探险\n"
            "  完成探索 → 领取奖励（含物品掉落）\n"
            "  退出秘境 → 放弃探索(无奖励)\n"
            "\n"
            "🔥【炼丹系统】(丹药存入丹药背包)\n"
            "  丹药配方 → 查看炼丹配方及成功率\n"
            "  炼丹 <配方ID> → 炼制丹药（消耗灵石+灵草）\n"
            "    └─ 成功后丹药存入丹药背包，用 /服用丹药 使用\n"
            "\n"
            "✨【传承系统】\n"
            "  传承信息 → 查看传承给你的属性加成\n"
            "\n"
            "🏔️【洞天福地】(个人修炼空间)\n"
            "  我的洞天 → 查看洞天信息和待收取收益\n"
            "  购买洞天 <1-5>\n"
            "    └─ 1:小洞天 2:中洞天 3:大洞天 4:福地 5:洞天福地\n"
            "  升级洞天 → 提升洞天等级增加收益\n"
            "  洞天收取 → 收取灵石和修为产出\n"
            "\n"
            "🌾【灵田种植】(收获存入储物戒)\n"
            "  我的灵田 → 查看灵田和种植情况\n"
            "  开垦灵田 → 花费灵石开垦灵田\n"
            "  种植 <灵草名>\n"
            "    └─ 灵草/血灵草/冰心草/火焰花/九叶灵芝\n"
            "  收获 → 收获灵草（自动存入储物戒）\n"
            "  升级灵田 → 增加种植格数\n"
            "\n"
            "💕【双修系统】(互增修为)\n"
            "  双修 <@某人> → 向对方发起双修请求\n"
            "  接受双修 → 接受双修，双方各获10%修为\n"
            "  拒绝双修 → 拒绝对方请求\n"
            "\n"
            "👁️【天地灵眼】(占据持续获益)\n"
            "  灵眼信息 → 查看灵眼及可抢占列表\n"
            "  抢占灵眼 <ID> → 占据无主灵眼\n"
            "  灵眼收取 → 收取灵眼修为产出\n"
            "  释放灵眼 → 释放已占据的灵眼\n"
            "\n"
            "━━━━━━━━━━━━━━━\n"
            "💡 提示: 指令前加 / 使用，如 /我要修仙"
        )
        yield event.plain_result(help_text)
